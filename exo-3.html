<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document exo 3 Nadjim Djamani</title>
</head>
<body>
    saisir le nom d'un ville : <br>
   <input type="text" id="city">  
   <div id="cityResult"></div>
   <div id="population"></div>
</body>
<script>
    (function() {
        // Constants
        const CITY_MIN_LEN = 2 ;
        const cities = [
            { name: 'Paris', population: 2187526 },
            { name: 'Marseille', population: 863310 },
            { name: 'Lyon', population: 516092 },
            { name: 'Toulouse', population: 479553 },
            { name: 'Nice', population: 340017 },
            { name: 'Niort', population: 340087 }
        ];

        // DOM targetting
        let txtCity        = document.getElementById('city');
        let divCityResult  = document.getElementById('cityResult');
        
        // Events
        txtCity.addEventListener('keyup', e => checkConditions(e));
        
        // Functions
        function checkConditions(e) {
            let isCityLengthOK = txtCity.value.length >= CITY_MIN_LEN;
            if (isCityLengthOK ) {
                autoCompletion();
            }
            else{
                divCityResult.innerHTML = "" ;
            }
        }

        function autoCompletion(){
            divCityResult.innerHTML = "<div><ul>" ;
            let cityValue = txtCity.value.trim();

            for(let i = 0; i < cities.length; i++) {
                let cityVisible = cities[i].name.includes(cityValue);
                if(cityVisible){
                    divCityResult.innerHTML += "<li class=\"cityClicable\"  >"+cities[i].name +"</li>" ;
                }
            }
            divCityResult.innerHTML += "</ul></div>" ;


            let cityClicable   = document.getElementsByClassName('cityClicable') ;
            for(let i = 0; i < cityClicable.length; i++) {
                cityClicable[i].addEventListener("click", function() {
                    console.log("Clicked index: " + i);
                    console.log(cityClicable[i].innerHTML)
                    
                });
            }
        }

      
            

    })();
</script>
</html>